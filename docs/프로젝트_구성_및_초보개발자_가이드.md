# BubbleMap 프로젝트 구성 정리 & 초보 개발자용 가이드

C/Python만 공부한 분을 위한 **프로젝트 구조 요약**과 **알아두면 좋은 개발 지식**입니다.

---

## 1. 프로그램이 어떻게 구성되어 있는지

### 1.1 전체 구조 (한눈에 보기)

```
Bubble-Map/
├── server.js          ← 백엔드 (Node.js) — 웹 서버 + 뉴스 API
├── package.json       ← 프로젝트 설정 & 사용 라이브러리 목록
├── .env.example       ← 환경 변수 예시 (API 키 등)
├── public/            ← 브라우저에 그대로 전달되는 "프론트엔드"
│   ├── index.html     ← 첫 화면 (HTML)
│   ├── css/style.css  ← 스타일 (색, 레이아웃)
│   └── js/            ← 화면 동작 (JavaScript)
│       ├── main.js         ← 진입점: 지도 초기화, 뉴스 로드, 버블 갱신
│       ├── mapRenderer.js  ← 2D 지도(Leaflet) 초기화
│       ├── bubbleComponent.js ← 말풍선(버블) 그리기/제거
│       └── newsService.js   ← 서버의 /api/news 호출
├── scripts/
│   └── download-earth-texture.js  ← 지구 텍스처 다운로드 스크립트
└── docs/              ← 문서
```

- **백엔드**: `server.js` 하나로 웹 서버 + 뉴스 API 제공  
- **프론트엔드**: `public/` 아래 HTML + CSS + JS (빌드 없이 브라우저에서 바로 실행)

---

### 1.2 실행 흐름 (사용자가 브라우저에서 접속했을 때)

1. **브라우저**가 `http://localhost:3000` 요청  
   → **Node.js(Express)** 가 `public/index.html` 을 보냄.

2. **index.html** 이 다음을 로드:
   - `css/style.css` (디자인)
   - Leaflet (지도 라이브러리, CDN)
   - `js/main.js` (타입: `module` → ES 모듈)

3. **main.js** 가 순서대로:
   - `mapRenderer.js` 로 지도 초기화 (`initMap`)
   - `newsService.js` 로 뉴스 가져오기 (`fetchNews` → 서버의 `GET /api/news`)
   - `bubbleComponent.js` 로 말풍선 추가 (`addBubbles`)
   - 타임라인 슬라이더 입력 시 필터 적용 후 버블 다시 그리기

4. **서버(server.js)** 의 동작:
   - `GET /` → `public/` 폴더의 정적 파일 제공 (index.html 등)
   - `GET /api/news` → 뉴스 API(NewsAPI) 또는 목(mock) 데이터를 가져와 JSON으로 응답

즉, **클라이언트(브라우저)** 와 **서버(Node.js)** 가 나뉘어 있고, 뉴스 데이터는 **서버 API 한 번** 거쳐서 오는 구조입니다.

---

### 1.3 파일별 역할 (요약)

| 파일 | 역할 |
|------|------|
| **server.js** | Express 서버, 정적 파일 서빙, `COUNTRY_COORDS`/카테고리 매핑, NewsAPI 호출 또는 mock, 캐시(5분), `GET /api/news` |
| **public/index.html** | 헤더, 지도 영역(`#map-container`), 요약 패널, 타임라인 슬라이더, 스크립트/스타일 로드 |
| **public/js/main.js** | 지도 초기화, 뉴스 fetch, 지역(region) 집계, 버블 갱신, 툴팁/요약 패널 업데이트, 타임라인 필터, `window.bubbleMap` 노출 |
| **public/js/mapRenderer.js** | Leaflet 2D 지도 생성, 타일 레이어(CARTO 다크), 레이어 그룹 반환 |
| **public/js/bubbleComponent.js** | 말풍선 크기/색(카테고리), `addBubbles` / `removeBubbles`, 연결선(2D에서는 없음) |
| **public/js/newsService.js** | `fetch('/api/news', ...)` 로 뉴스 JSON 받아서 반환 |
| **public/css/style.css** | 레이아웃, 헤더, 지도/패널, 버블/툴팁/타임라인 스타일 |

---

### 1.4 데이터 흐름 (간단히)

```
[NewsAPI 또는 Mock]
        ↓
  server.js: loadNews() → normalizeArticle()
        ↓
  GET /api/news → JSON 배열 (id, title, summary, lat, lng, category, importance, ...)
        ↓
  main.js: fetchNews() → articles
        ↓
  articlesToRegions() → 국가별로 묶어서 regions
        ↓
  addBubbles(regions) → 지도 위에 말풍선 표시
        ↓
  클릭 시 updateSummaryPanel(region) → 오른쪽 패널에 상위 3개 뉴스
```

C/Python으로 치면:  
- **서버** = 데이터를 가공해서 내려주는 프로그램  
- **클라이언트** = 그 데이터를 받아서 지도와 말풍선으로 그려 주는 프로그램  

---

## 2. C/Python 초보자가 알면 좋은 개발 지식

### 2.1 이 프로젝트에서 쓰는 언어/기술

- **JavaScript (JS)**  
  - 브라우저에서 돌아가는 스크립트 언어.  
  - C처럼 `if/for/함수` 가 있고, Python처럼 타입을 안 붙여도 됨.  
  - 이 프로젝트는 **ES 모듈** 사용: `import` / `export` 로 파일끼리 나눔.

- **Node.js**  
  - JavaScript를 **서버(컴퓨터)에서** 실행하게 해 주는 런타임.  
  - `server.js` 는 Node로 실행됨 (`node server.js`).

- **HTML / CSS**  
  - HTML: 화면에 무엇을 둘지(버튼, 지도 영역, 패널 등).  
  - CSS: 그걸 어떻게 보이게 할지(색, 크기, 정렬).

정리: **백엔드 = Node.js + JavaScript**, **프론트엔드 = HTML + CSS + JavaScript**.

---

### 2.2 C/Python과 비교해서 익숙해지면 좋은 것

1. **비동기(async) / Promise**  
   - 네트워크 요청(뉴스 가져오기)은 끝나기까지 시간이 걸림.  
   - C의 블로킹 대기와 달리, JS는 보통 **기다리는 동안 다른 일을 함**.  
   - `async/await` 와 `Promise` 가 그걸 표현하는 방식.  
   - 예: `const articles = await fetchNews();` → “fetchNews가 끝날 때까지 기다린 뒤 결과를 articles에 넣는다.”

2. **이벤트 기반**  
   - “버튼 클릭”, “슬라이더 변경”, “마우스 올리기” 같은 **이벤트**가 발생하면, 등록해 둔 함수가 실행됨.  
   - `timelineEl.addEventListener('input', applyTimelineFilter)` 같은 식.  
   - Python의 “입력 받고 반응”과 비슷하지만, 브라우저가 이벤트를 쏴 주는 구조.

3. **DOM (Document Object Model)**  
   - HTML 요소 하나하나를 JS로 조작하는 것.  
   - `document.getElementById('map-container')`, `summaryContainer.innerHTML = ...` 같은 코드가 DOM 조작.  
   - “화면에 보이는 것 = DOM” 이라고 보면 됨.

4. **모듈 (import/export)**  
   - Python의 `import` 처럼, JS도 파일을 나누고 `import` / `export` 로 연결.  
   - 이 프로젝트는 `<script type="module" src="js/main.js">` 로 main.js를 모듈로 불러서, 그 안에서 `mapRenderer.js`, `newsService.js` 등을 import.

5. **환경 변수 (.env)**  
   - API 키 같은 비밀은 코드에 넣지 않고, `.env` 파일에 넣고 `process.env.NEWS_API_KEY` 로 읽음.  
   - Python의 `os.environ` 이나 dotenv 쓰는 방식과 같은 개념.

---

### 2.3 용어만 짚고 가기

- **API (Application Programming Interface)**  
  - “다른 프로그램이 우리 서버에 요청할 수 있는 창구”.  
  - 이 프로젝트에서는 `GET /api/news` 가 우리가 만든 API이고, NewsAPI는 외부 API.

- **JSON**  
  - 데이터를 문자열로 주고받는 형식.  
  - Python의 `dict`/`list` 를 문자열로 만든 것과 비슷.  
  - `res.json()` 으로 응답 본문을 객체로 파싱함.

- **npm**  
  - Node 패키지 관리자. `package.json` 에 적힌 라이브러리들을 `npm install` 로 받음.  
  - Python의 pip + requirements.txt 역할.

- **Express**  
  - Node.js용 웹 프레임워크. “이 URL로 오면 이 함수 실행” 같은 라우팅을 쉽게 해 줌.

---

### 2.4 수정해 보고 싶을 때 추천 순서

1. **문구/레이아웃**  
   - `public/index.html` (제목, 라벨), `public/css/style.css` (색, 간격).

2. **버블 색/크기**  
   - `public/js/bubbleComponent.js` 의 `CATEGORY_COLORS`, `BUBBLE_RADIUS_MIN/MAX`.

3. **뉴스 표시 개수**  
   - `public/js/main.js` 의 `slice(0, 3)` → 3을 5로 바꾸면 상위 5개까지 표시.

4. **서버 쪽 국가/카테고리**  
   - `server.js` 의 `COUNTRY_COORDS`, `CATEGORY_IMPORTANCE`, `getMockArticles()`.

5. **새 API 추가**  
   - `server.js` 에 `app.get('/api/...', ...)` 추가 후, `newsService.js` 또는 main.js에서 `fetch('/api/...')` 호출.

---

## 3. 한 줄 요약

- **구성**: Node.js(Express) 서버가 `public/` 을 서빙하고, `GET /api/news` 로 뉴스 JSON을 주고, 브라우저의 main.js가 지도(Leaflet) 위에 말풍선으로 그린다.  
- **초보자에게 유용한 개념**: JavaScript(브라우저 + Node), 비동기(async/await), 이벤트, DOM, 모듈(import/export), API/JSON, npm/Express.

C/Python으로 배운 “입력 → 처리 → 출력” 구조는 그대로 있고, 여기서는 “웹 요청/이벤트 → 처리 → 화면(DOM)/API 응답”으로 확장된 형태라고 보면 됩니다.
